(this["webpackJsonpncd-ii-demo"]=this["webpackJsonpncd-ii-demo"]||[]).push([[0],{100:function(e,t){},118:function(e,t){},146:function(e,t,n){"use strict";n.r(t);var c=n(8),a=n.n(c),o=n(33),r=n(77),s=n(0),i=n(41),l=n.n(i),d=n(4),u=(n(57),n(42)),j=n.n(u),b=n(149),m=n(147),x=n(1),f=function(e){var t=e.election,n=e.index,c=e.delay,a=(e.contract,e.currentUser,e.nearConfig,e.wallet,e.onElectionSelected),o=Object(s.useState)(!1),r=Object(d.a)(o,2),i=r[0],l=r[1],u=k(t.creationDate),j=k(t.startDate),f=k(t.endDate),g=Object(m.a)((function(){return l(!0)}),200*n),h=Object(d.a)(g,3)[2];return Object(s.useEffect)((function(){h()}),[h]),Object(x.jsx)(b.a,{as:s.Fragment,show:i,enter:"transform transition duration-[".concat(c,"ms]"),enterFrom:"opacity-0 rotate-[-120deg] scale-50",enterTo:"opacity-100 rotate-0 scale-100",leave:"transform duration-200 transition ease-in-out",leaveFrom:"opacity-100 rotate-0 scale-100 ",leaveTo:"opacity-0 scale-95 ",children:Object(x.jsxs)("div",{onClick:function(){return a(t)},className:"w-400 bg-gradient-to-r from-yellow-400 to-red-500 p-6 max-w-sm mx-auto rounded-xl flex-col shadow-md flex items-center space-x-4 cursor-pointer",children:[Object(x.jsx)("div",{className:"text-xl font-medium text-black",children:t.title}),Object(x.jsx)("div",{className:"text-xl font-medium text-black",children:t.description}),Object(x.jsxs)("div",{className:"text-md font-medium text-black text",children:["Created at: ",y(u)]}),Object(x.jsxs)("div",{className:"text-md font-medium text-black text",children:[y(j)," - ",y(f)]})]})})},g=n(150);function h(e){return Object(x.jsxs)("svg",Object(o.a)(Object(o.a)({viewBox:"0 0 24 24",fill:"none"},e),{},{children:[Object(x.jsx)("circle",{cx:12,cy:12,r:12,fill:"#fff",opacity:"0.2"}),Object(x.jsx)("path",{d:"M7 13l3 3 7-7",stroke:"#fff",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})]}))}var O=function(e){e.election;var t=e.candidates,n=(e.contract,e.currentUser,e.nearConfig,e.wallet,e.onCandidateSelected),c=Object(s.useState)(),a=Object(d.a)(c,2),o=a[0],r=a[1];return Object(x.jsx)(x.Fragment,{children:Object(x.jsx)("div",{className:"w-full",children:Object(x.jsxs)(g.a,{value:o,onChange:function(e){r(e),n(e)},children:[Object(x.jsx)(g.a.Label,{className:"sr-only",children:"Server size"}),Object(x.jsx)("div",{className:"flex flex-col justify-between",children:t.map((function(e,t){return Object(x.jsx)(g.a.Option,{value:e.accountId,className:function(e){var t=e.active,n=e.checked;return"".concat(t?"ring-2 ring-offset-2 ring-offset-sky-300 ring-white ring-opacity-60":"","\n                      ").concat(n?"bg-sky-900 bg-opacity-75 text-white bg-green-500":"bg-white","\n                      w-full min-w-10 relative rounded-lg shadow-md px-5 py-4 cursor-pointer flex focus:outline-none m-2")},children:function(t){t.active;var n=t.checked;return Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)("div",{className:"flex items-center justify-between w-full",children:[Object(x.jsx)("div",{className:"flex items-center",children:Object(x.jsxs)("div",{className:"text-sm",children:[Object(x.jsxs)(g.a.Label,{as:"div",className:"font-medium flex align-center ".concat(n?"text-white":"text-gray-900"),children:[Object(x.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-2 flex-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(x.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})}),Object(x.jsx)("p",{className:"flex-grow",children:e.accountId})]}),Object(x.jsxs)(g.a.Description,{as:"span",className:"inline mx-2".concat(n?"text-sky-100 bg-green-400":"text-gray-500"),children:[Object(x.jsxs)("div",{className:"flex",children:[Object(x.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-2 flex-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(x.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),Object(x.jsx)("p",{className:"flex-grow",children:e.name})]}),Object(x.jsxs)("div",{className:"flex",children:[Object(x.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"flex-none mr-2 h-6 w-6 ",viewBox:"0 0 20 20",fill:"currentColor",children:Object(x.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),Object(x.jsx)("p",{className:"flex-grow",children:e.slogan})]}),Object(x.jsxs)("div",{className:"flex",children:[Object(x.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"flex-none mr-2 h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(x.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),Object(x.jsx)("p",{className:"flex-grow",children:e.goals})]})]})]})}),n&&Object(x.jsx)("div",{className:"flex-shrink-0 text-white",children:Object(x.jsx)(h,{className:"w-6 h-6"})})]})})}},t)}))})]})})})},v=n(148);function p(e){var t=e.onClose,n=e.election,c=e.contract,a=(e.currentUser,e.nearConfig,e.wallet,e.onCandidateAdded),o=Object(s.useState)(""),r=Object(d.a)(o,2),i=r[0],l=r[1],u=Object(s.useState)(""),j=Object(d.a)(u,2),m=j[0],f=j[1],g=Object(s.useState)("My goals"),h=Object(d.a)(g,2),O=h[0],p=h[1];return Object(x.jsx)(x.Fragment,{children:Object(x.jsx)(b.a,{appear:!0,show:!0,as:s.Fragment,children:Object(x.jsx)(v.a,{as:"div",className:"fixed inset-0 z-10 overflow-y-auto",onClose:t,children:Object(x.jsxs)("div",{className:"min-h-screen px-4 text-center",children:[Object(x.jsx)(b.a.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:Object(x.jsx)(v.a.Overlay,{className:"fixed inset-0"})}),Object(x.jsx)("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"\u200b"}),Object(x.jsx)(b.a.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:Object(x.jsxs)("div",{className:"inline-block w-full max-w-md p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[Object(x.jsx)(v.a.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900",children:"Register as a cadidate"}),Object(x.jsx)(w,{label:"Name",value:i,onValueChange:function(e){return l(e.target.value)}}),Object(x.jsx)(w,{label:"Slogan",value:m,onValueChange:function(e){return f(e.target.value)}}),Object(x.jsx)(w,{label:"Goals",value:O,lines:4,onValueChange:function(e){return p(e.target.value)}}),Object(x.jsxs)("div",{className:"mt-4 flex justify-between",children:[Object(x.jsx)("button",{type:"button",className:"inline-flex justify-center px-4 py-2 text-sm font-medium text-blue-900 bg-red-100 border border-transparent rounded-md hover:bg-red-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500",onClick:t,children:"Cancel"}),Object(x.jsx)("button",{type:"button",className:"inline-flex justify-center px-4 py-2 text-sm font-medium text-blue-900 bg-blue-100 border border-transparent rounded-md hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500",onClick:function(){c.add_candidacy({electionId:n.id,name:i,slogan:m,goals:O}).then((function(){a()}),(function(e){console.log(e)}))},children:"Submit"})]})]})})]})})})})}var w=function(e){var t=e.label,n=e.value,c=e.lines,a=e.onValueChange;return Object(x.jsx)("div",{children:Object(x.jsxs)("div",{className:"flex flex-row mt-2 relative rounded-md",children:[Object(x.jsx)("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700 mr-10 w-8",children:t}),c?Object(x.jsx)("textarea",{className:"border-2 p-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-200 rounded-md",name:t,id:t,rows:c,onChange:a}):Object(x.jsx)("input",{type:"text",name:t,id:t,className:"border-2 p-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-200 rounded-md",value:n,onChange:a})]})})},N=function(e){var t=e.election,n=e.contract,c=e.currentUser,a=e.nearConfig,o=e.wallet,r=e.onClose,i=e.onLoading,l=Object(s.useState)(!1),u=Object(d.a)(l,2),f=u[0],g=u[1],h=Object(s.useState)("#000"),v=Object(d.a)(h,2),w=v[0],N=v[1],C=Object(s.useState)([]),S=Object(d.a)(C,2),_=S[0],L=S[1],E=Object(s.useState)(!1),U=Object(d.a)(E,2),F=U[0],I=U[1],M=Object(s.useState)(!1),T=Object(d.a)(M,2),D=T[0],A=T[1],z=k(t.creationDate),B=k(t.startDate),R=k(t.endDate),V=Object(m.a)((function(){return g(!0)}),100),W=Object(d.a)(V,3)[2],H=Object(s.useState)(!1),G=Object(d.a)(H,2),K=G[0],P=G[1],J=Object(s.useState)(),q=Object(d.a)(J,2),Q=q[0],X=q[1];Object(s.useEffect)((function(){c&&n.get_god_mode({accountId:c.accountId}).then((function(e){P(e)}))}),[K,n,c]),Object(s.useEffect)((function(){i&&(i(!0),n.get_candidates({electionId:t.id}).then((function(e){i(!1),L(e)}),(function(e){i(!1)})))}),[n,t.id,F,i]);return Object(s.useEffect)((function(){W()}),[W]),Object(x.jsx)(b.a,{as:s.Fragment,show:f,enter:"transform transition duration-[250ms]",enterFrom:"opacity-0 rotate-[-120deg] scale-50",enterTo:"opacity-100 rotate-0 scale-100",leave:"transform duration-200 transition ease-in-out",leaveFrom:"opacity-100 rotate-0 scale-100 ",leaveTo:"opacity-0 scale-95 ",children:Object(x.jsxs)("div",{className:"mw-800 bg-gradient-to-r from-indigo-300 to-indigo-500 p-6 rounded-xl flex-col shadow-md flex space-x-4",children:[Object(x.jsxs)("div",{className:"text-2xl flex justify-between font-medium items-center mb-4",children:[Object(x.jsx)("button",{onClick:function(){return A(!0)},disabled:!function(){return K||B<j()()},className:"disabled:opacity-50 mt-2 bg-green-500 hover:bg-green-700 w-14 h-14 text-white font-bold py-2 px-4 rounded-xl float-right",children:Object(x.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(x.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})})}),Object(x.jsx)("div",{className:"mt-2 text-2xl text-center font-medium text-black",children:t.title}),Object(x.jsx)("button",{className:"font-medium ",onClick:r,onMouseEnter:function(){return N("#ddd")},onMouseLeave:function(){return N("#000")},children:Object(x.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:w,children:Object(x.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Object(x.jsxs)("div",{className:"text-xl font-medium text-black",children:[t.description,Object(x.jsx)("button",{className:"disabled:opacity-50 bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded float-right",onClick:function(){i&&(i(!0),n.add_vote({electionId:t.id,candidateId:Q,comment:""}).then((function(e){i(!1),L(e)}),(function(e){i(!1)})))},disabled:!Q,children:"Submit vote"})]}),Object(x.jsxs)("div",{className:"text-md font-medium text-black text",children:["Created at: ",y(z)]}),Object(x.jsxs)("div",{className:"text-md font-medium text-black text",children:[y(B)," - ",y(R)]}),Object(x.jsx)("div",{className:"text-xl font-medium text-black text-center",children:_.length>0?"Candidates:":"No cadidates yes, apply to be the first"}),D&&Object(x.jsx)("div",{className:"backdrop-filter backdrop-blur-lg mx-auto w-80",children:Object(x.jsx)(p,{election:t,contract:n,currentUser:c,nearConfig:a,wallet:o,onCandidateAdded:function(){I(!0),A(!1)},onClose:function(){return A(!1)}})}),_&&Object(x.jsx)("div",{children:Object(x.jsx)(O,{election:t,candidates:_,contract:n,currentUser:c,nearConfig:a,wallet:o,onCandidateSelected:X})})]})})},y=function(e){return e.format("DD MMM yyyy HH:MM")},k=function(e){var t=Math.floor(e/1e6).toFixed();return j()(t,"x")},C=function(e){var t=e.contract,n=e.currentUser,c=e.nearConfig,a=e.wallet,o=e.onLoading,r=Object(s.useState)(),i=Object(d.a)(r,2),l=i[0],u=i[1],j=Object(s.useState)(),b=Object(d.a)(j,2),m=b[0],g=b[1],h=function(e){localStorage.setItem("activeElection",e.id),g(e)};return Object(s.useEffect)((function(){if(l){var e=localStorage.getItem("activeElection");l.filter((function(t){return"".concat(t.id)===e})).forEach((function(e){g(e)}))}}),[l]),Object(s.useEffect)((function(){o&&(o(!0),t.get_elections().then((function(e){o(!1),u(e)}),(function(e){o(!1)})))}),[t,o]),Object(x.jsxs)("div",{className:"container mx-auto flex-row",children:[!m&&Object(x.jsx)("div",{className:"grid lg:grid-cols-4 md:grid-cols-2 xs:grid-cols-1 gap-4",children:l&&l.map((function(e,o){return Object(x.jsx)(f,{election:e,index:o,contract:t,currentUser:n,nearConfig:c,wallet:a,onElectionSelected:h},e.id)}))}),m&&Object(x.jsx)("div",{className:"grid grid-cols-1",children:Object(x.jsx)(N,{election:m,contract:t,currentUser:n,nearConfig:c,wallet:a,onLoading:o,onClose:function(){localStorage.removeItem("activeElection"),g(null)}})})]})},S=n(151),_=function(e){var t=e.contract,n=e.currentUser,c=(e.nearConfig,e.wallet,e.onLoading),a=Object(s.useState)(!1),o=Object(d.a)(a,2),r=o[0],i=o[1];Object(s.useEffect)((function(){n&&t.get_god_mode({accountId:n.accountId}).then((function(e){console.log("God mode: [".concat(e,"]")),i(e)}),(function(e){console.log(e)}))}),[r,t,n]);return Object(x.jsxs)("div",{className:"flex-row content-between",children:[Object(x.jsx)("span",{children:"God mode: "}),Object(x.jsxs)(S.a,{checked:r,onChange:function(e){e?(c(!0),t.god_mode_on({}).then((function(){i(!0),c(!1)}),(function(e){c(!1)}))):(c(!0),t.god_mode_off({}).then((function(){i(!1),c(!1)}),(function(e){c(!1)})))},className:"".concat(r?"bg-blue-600":"bg-gray-200"," relative inline-flex items-center h-6 rounded-full w-11"),children:[Object(x.jsx)("span",{className:"sr-only",children:"God mode"}),Object(x.jsx)("span",{className:"".concat(r?"translate-x-6":"translate-x-1"," inline-block w-4 h-4 transform bg-white rounded-full")})]})]})},L=function(e){var t=e.contract,n=e.currentUser,c=e.nearConfig,a=e.wallet,o=e.onLoading,r=Object(s.useState)(!0),i=Object(d.a)(r,2),l=i[0],u=i[1],j=Object(m.a)((function(){return u(!0)}),500),f=Object(d.a)(j,3)[2];return Object(s.useEffect)((function(){f()}),[f]),Object(x.jsx)(x.Fragment,{children:Object(x.jsx)(b.a,{as:s.Fragment,show:l,enter:"transform transition duration-[500ms]",enterFrom:"opacity-0 rotate-[-120deg] scale-50",enterTo:"opacity-100 rotate-0 scale-100",leave:"transform duration-200 transition ease-in-out",leaveFrom:"opacity-100 rotate-0 scale-100 ",leaveTo:"opacity-0 scale-95 ",children:Object(x.jsxs)("div",{className:"flex justify-between bg-gradient-to-r from-green-400 to-blue-500 mt-6 p-2 mx-auto rounded-xl shadow-md items-center space-x-4",children:[Object(x.jsx)("img",{className:"h-14 w-20",src:"https://docs.near.org/img/near_logo.svg",alt:"NEAR Logo"}),Object(x.jsx)("div",{className:"text-xl md:pl-60 font-medium text-black uppercase",children:"Voting is cool \ud83d\ude0e"}),Object(x.jsxs)("div",{className:"flex justify-between",children:[n&&Object(x.jsxs)("div",{className:"mr-8",children:[Object(x.jsxs)("p",{className:"text-black-500",children:["Account ID: ",n.accountId]}),Object(x.jsx)(_,{contract:t,currentUser:n,nearConfig:c,wallet:a,onLoading:o})]}),n?Object(x.jsx)("button",{className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded float-right",onClick:function(){a.signOut(),window.location.replace(window.location.origin+window.location.pathname)},children:"Logout"}):Object(x.jsx)("button",{className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded float-right",onClick:function(){a.requestSignIn(c.contractName,"NEAR Voting App")},children:"Login"})]})]})})})},E=function(e){var t=e.isLoading;return Object(x.jsx)(x.Fragment,{children:t?Object(x.jsx)("div",{className:"my-4 mx-auto loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-12 w-12"}):Object(x.jsx)("div",{className:"my-4 h-12 w-12"})})},U=function(e){var t=e.contract,n=e.currentUser,c=e.nearConfig,a=e.wallet,o=Object(s.useState)(!1),r=Object(d.a)(o,2),i=r[0],l=r[1];return Object(x.jsxs)("div",{className:"container mx-auto",children:[Object(x.jsx)(L,{contract:t,currentUser:n,nearConfig:c,wallet:a,onLoading:l}),Object(x.jsx)(E,{isLoading:i}),n&&Object(x.jsx)(C,{contract:t,currentUser:n,nearConfig:c,wallet:a,onLoading:l})]})},F=(n(84),n(78)),I=n.n(F),M=n(34);function T(){return(T=Object(r.a)(a.a.mark((function e(){var t,n,c,r,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=I()("production"),e.next=3,M.connect(Object(o.a)({deps:{keyStore:new M.keyStores.BrowserLocalStorageKeyStore}},t));case 3:if(n=e.sent,!(c=new M.WalletConnection(n)).getAccountId()){e.next=11;break}return e.t0=c.getAccountId(),e.next=9,c.account().state();case 9:e.t1=e.sent.amount,r={accountId:e.t0,balance:e.t1};case 11:return e.next=13,new M.Contract(c.account(),t.contractName,{viewMethods:["get_elections","get_candidates","get_votes","get_god_mode"],changeMethods:["add_election","add_candidacy","add_vote","god_mode_on","god_mode_off"],sender:c.getAccountId()});case 13:return s=e.sent,e.abrupt("return",{contract:s,currentUser:r,nearConfig:t,walletConnection:c});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}window.nearInitPromise=function(){return T.apply(this,arguments)}().then((function(e){var t=e.contract,n=e.currentUser,c=e.nearConfig,a=e.walletConnection;l.a.render(Object(x.jsx)(U,{contract:t,currentUser:n,nearConfig:c,wallet:a}),document.getElementById("root"))}))},78:function(e,t){var n=Object({NODE_ENV:"production",PUBLIC_URL:"/nearvember-challenge-8",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).CONTRACT_NAME||"dev-1637962142021-34818082741173";e.exports=function(e){switch(e){case"mainnet":return{networkId:"mainnet",nodeUrl:"https://rpc.mainnet.near.org",contractName:n,walletUrl:"https://wallet.near.org",helperUrl:"https://helper.mainnet.near.org"};case"production":case"development":case"testnet":return{networkId:"testnet",nodeUrl:"https://rpc.testnet.near.org",contractName:n,walletUrl:"https://wallet.testnet.near.org",helperUrl:"https://helper.testnet.near.org"};default:throw Error("Unconfigured environment '".concat(e,"'. Can be configured in src/config.js."))}}},84:function(e,t,n){},90:function(e,t){}},[[146,1,2]]]);
//# sourceMappingURL=main.870e00b7.chunk.js.map